{"version":3,"sources":["SchemaCollaborationUtils.js","index.js","../node_modules/tableschema/lib/profiles sync /^/.//.*/.json$","../node_modules/datapackage/lib/profiles sync /^/.//.*/.json$","EditorSchemaCollaborationButtons.js","SchemaCollaborationSaveToServer.js"],"names":["getParameterFromUrlByName","name","url","window","location","href","replace","results","RegExp","exec","decodeURIComponent","EditorSchemaCollaborationButtons","require","console","log","datapackageUI","render","EditorPackage","descriptor","Buttons","document","getElementById","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","axios","React","useEffect","connect","ToastContainer","onSaveToServer","EditorSchemaCollaborationButtonsPure","encodedDescriptor","onUploadChange","onValidateClick","onLoadFromServer","loadFromServerButton","click","position","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","draggable","className","title","htmlFor","type","value","style","display","onChange","onClick","download","ref","button","dispatch","ev","reader","FileReader","readAsText","target","files","onload","payload","JSON","parse","result","uuid","get","then","resp","data","toast","method","res","info","catch","err"],"mappings":"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","file":"static/js/main.2f57d67b.chunk.js","sourcesContent":["export function getParameterFromUrlByName(name, url) {\n  // Copied and slightly changed from https://stackoverflow.com/a/901144/9294284\n  // (it seems to be CC-BY-SA 4.0, I might replace this after prototyping)\n  if (!url) url = window.location.href\n\n  name = name.replace(/[[\\]]/g, '\\\\$&')\n  var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)')\n  var results = regex.exec(url)\n  if (!results) return null\n  if (!results[2]) return ''\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '))\n}\n","import React from \"react\";\nimport \"./index.css\";\nimport 'react-toastify/dist/ReactToastify.css';\nimport datapackageUI from \"datapackage-ui/lib\";\n\n// import EditorSchemaCollaborationButtons from \"./EditorSchemaCollaborationButtons\";\nconst { EditorSchemaCollaborationButtons } = require('./EditorSchemaCollaborationButtons')\n\nfunction Buttons() {\n  return EditorSchemaCollaborationButtons\n}\n  \nconsole.log(EditorSchemaCollaborationButtons)\n\ndatapackageUI.render(\n  datapackageUI.EditorPackage,\n  {\n    descriptor: {},\n    Buttons: EditorSchemaCollaborationButtons\n  },\n  document.getElementById(\"root\")\n);\n","var map = {\n\t\"./geojson.json\": 216,\n\t\"./table-schema.json\": 440,\n\t\"./topojson.json\": 217\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 439;","var map = {\n\t\"./data-package.json\": 576,\n\t\"./data-resource.json\": 577,\n\t\"./fiscal-data-package.json\": 578,\n\t\"./registry.json\": 579,\n\t\"./tabular-data-package.json\": 580,\n\t\"./tabular-data-resource.json\": 581\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 575;","const axios = require('axios')\nconst React = require('react')\nconst { useEffect } = require('react')\nconst { connect } = require('react-redux')\nconst { ToastContainer } = require('react-toastify')\n\nconst onSaveToServer = require('./SchemaCollaborationSaveToServer').onSaveToServer\nconst getParameterFromUrlByName = require('./SchemaCollaborationUtils').getParameterFromUrlByName\n\n// Pure components\n\nfunction EditorSchemaCollaborationButtonsPure({\n  encodedDescriptor,\n\n  // Handlers\n  onUploadChange,\n  onValidateClick,\n\n  onLoadFromServer,\n}) {\n  // Horrible way to trigger a load from server on the Datapackage-UI load\n  useEffect(() =>\n    this.loadFromServerButton.click()\n  , [])\n\n  return (\n    <div>\n      <ToastContainer\n          position=\"top-left\"\n          autoClose={5000}\n          hideProgressBar={false}\n          newestOnTop={false}\n          closeOnClick\n          rtl={false}\n          draggable\n          />\n\n      {/* Upload */}\n      <label\n        className=\"btn btn-lg btn-success\"\n        title=\"Upload a data package from your local drive\"\n        htmlFor=\"load-descriptor\"\n      >\n        <input\n          type=\"file\"\n          id=\"load-descriptor\"\n          value=\"\"\n          style={{ display: 'none' }}\n          onChange={onUploadChange}\n        />\n        Upload\n      </label>\n\n      {/* Validate */}\n      <button\n        className=\"btn btn-lg btn-info\"\n        title=\"Validate the data package verifying its metadata\"\n        onClick={onValidateClick}\n      >\n        Validate\n      </button>\n\n      {/* Download */}\n      <a\n        className=\"btn btn-lg btn-success\"\n        href={`data: ${encodedDescriptor}`}\n        download=\"datapackage.json\"\n        title=\"Download the data package to your local drive\"\n      >\n        Download\n      </a>\n\n      {/* Save to server */}\n      <button\n        className=\"btn btn-lg btn-info\"\n        title=\"Save current schema to the server\"\n        onClick={() => onSaveToServer(`${decodeURIComponent(encodedDescriptor)}`)}\n      >\n        Save to server\n      </button>\n\n      {/* Load from server */}\n      <button\n        className=\"btn btn-lg btn-info\"\n        title=\"Load from the server\"\n        onClick={onLoadFromServer}\n        ref={(button) => { this.loadFromServerButton = button }}\n      >\n        Load from the server\n      </button>\n    </div>\n  )\n}\n\n// Handlers\n\nconst mapDispatchToProps = (dispatch) => ({\n  onUploadChange: (ev) => {\n    const reader = new window.FileReader()\n    reader.readAsText(ev.target.files[0])\n    reader.onload = () => {\n      dispatch({\n        type: 'UPLOAD_PACKAGE',\n        payload: JSON.parse(reader.result),\n      })\n    }\n  },\n\n  onValidateClick: () => {\n    dispatch({\n      type: 'VALIDATE_PACKAGE',\n    })\n  },\n\n  onLoadFromServer: () => {\n    const uuid = getParameterFromUrlByName('load')\n    axios.get('/api/datapackage/' + uuid + '/').then((resp) => {\n      console.log(resp.data)\n      dispatch({\n        type: 'UPLOAD_PACKAGE',\n        payload: resp.data,\n      })\n    })\n  },\n})\n\n// Wrappers\n\nconst EditorSchemaCollaborationButtons = connect(null, mapDispatchToProps)(EditorSchemaCollaborationButtonsPure)\n\n// System\n\nmodule.exports = {\n  // Public\n  EditorSchemaCollaborationButtons,\n\n  // Private\n  EditorSchemaCollaborationButtonsPure,\n}\n","const axios = require('axios')\nconst { toast } = require('react-toastify')\n\nconst getParameterFromUrlByName = require('./SchemaCollaborationUtils').getParameterFromUrlByName\n\nexport function onSaveToServer(data) {\n  // Example found in https://codereviewvideos.com/course/symfony-3-with-reactjs-and-angular/video/react-create-post\n  const uuid = getParameterFromUrlByName('load')\n\n  let url = ''\n  let method = ''\n  // eslint-disable-next-line no-undef\n\n  if (uuid === null) {\n    url = '/api/datapackage/'\n    method = 'POST'\n  } else {\n    url = '/api/datapackage/' + uuid + '/'\n    method = 'PUT'\n  }\n\n  return axios(url, {\n    method: method,\n    data: data,\n  })\n    .then((res) => {\n      // TODO: move this from here: the user of this function should do this\n      // eslint-disable-next-line no-undef\n      toast.info('Saved! UUID: ' + res.data.uuid, {\n        className: 'toast-info'\n      })\n      return res\n    })\n    .catch((err) => err)\n}\n"],"sourceRoot":""}